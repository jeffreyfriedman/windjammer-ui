[workspace]
members = [
    ".",
    "windjammer-ui-macro",
]

[workspace.package]
version = "0.3.6"
edition = "2021"
authors = ["Jeffrey Friedman <20387583+jeffreyfriedman@users.noreply.github.com>", "Windjammer Contributors"]
license = "MIT OR Apache-2.0"
rust-version = "1.90"
repository = "https://github.com/jeffreyfriedman/windjammer-ui"
homepage = "https://github.com/jeffreyfriedman/windjammer-ui"
documentation = "https://docs.rs/windjammer-ui"

[package]
name = "windjammer-ui"
version.workspace = true
edition.workspace = true
authors.workspace = true
license.workspace = true
rust-version.workspace = true
repository.workspace = true
homepage.workspace = true
documentation.workspace = true
description = "Cross-platform UI framework for Windjammer (Web, Desktop, Mobile)"
keywords = ["ui", "framework", "cross-platform", "wasm", "tauri"]
categories = ["gui", "web-programming", "wasm"]
# Explicitly include generated files (they're committed to git for cargo publish)
include = [
    "src/**/*",
    "examples/**/*",
    "tests/**/*",
    "benches/**/*",
    "build.rs",
    "Cargo.toml",
    "README.md",
    "LICENSE-MIT",
    "LICENSE-APACHE",
]

[lib]
name = "windjammer_ui"
path = "src/lib.rs"
crate-type = ["cdylib", "rlib"]

[[bin]]
name = "serve_wasm"
path = "src/bin/serve_wasm.rs"

[[bin]]
name = "counter_wasm"
path = "src/bin/counter_wasm.rs"

[dependencies]
# Proc macro for #[component]
windjammer-ui-macro = { path = "windjammer-ui-macro", version = "0.3.6" }

# Core dependencies
serde = { version = "1.0", features = ["derive"] }
serde_json = "1.0"
urlencoding = "2.1"
smallvec = "1.13"
uuid = { version = "1.0", features = ["v4", "js"] }

# Async runtime
tokio = { version = "1.35", features = ["full"], optional = true }

# Web platform (WASM)
wasm-bindgen = { version = "0.2", optional = true }
web-sys = { version = "0.3", features = [
    "Document",
    "Element",
    "HtmlElement",
    "Node",
    "NodeList",
    "Text",
    "Window",
    "EventTarget",
    "Event",
    "MouseEvent",
    "KeyboardEvent",
    "DomTokenList",
    "CssStyleDeclaration",
    "console",
], optional = true }
js-sys = { version = "0.3", optional = true }

# Desktop platform (eframe + egui)
egui = { version = "0.29", optional = true }
eframe = { version = "0.29", optional = true, default-features = false, features = ["wgpu"] }
egui_dock = { version = "0.14", optional = true }
png = { version = "0.17", optional = true }

# Editor features
rfd = { version = "0.16", optional = true }  # File dialogs
syntect = { version = "5.0", optional = true }  # Syntax highlighting
notify = { version = "6.0", optional = true }  # File watching

# Desktop platform (Tauri - legacy, keeping for compatibility)
tauri = { version = "2.0", features = ["protocol-asset"], optional = true }

# Mobile platform (iOS)
objc = { version = "0.2", optional = true }
cocoa = { version = "0.25", optional = true }

# Mobile platform (Android)
jni = { version = "0.21", optional = true }

# WASM utilities
console_error_panic_hook = { version = "0.1", optional = true }

[dev-dependencies]
tokio-test = "0.4"
criterion = "0.5"
# egui_kittest = "0.29"  # Disabled due to version conflicts

[[bench]]
name = "signal_benchmarks"
harness = false

[features]
default = ["web"]

# Platform features
web = ["wasm-bindgen", "web-sys", "js-sys", "console_error_panic_hook"]
desktop = ["eframe", "egui", "egui_dock", "png", "tokio", "rfd", "syntect", "notify"]
desktop-tauri = ["tauri", "tokio"]
mobile-ios = ["objc", "cocoa"]
mobile-android = ["jni"]

# All platforms (for testing)
all-platforms = ["web", "desktop", "mobile-ios", "mobile-android"]

